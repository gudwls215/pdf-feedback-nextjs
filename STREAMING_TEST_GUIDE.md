# 로컬 스트리밍 테스트 가이드

## 1. 시그널링 서버 설치 및 실행

### 시그널링 서버 의존성 설치
```bash
cd signaling-server
npm install
```

### 시그널링 서버 실행
```bash
npm start
```
또는 개발용:
```bash
npm run dev
```

서버가 실행되면 콘솔에 다음이 표시됩니다:
```
Signaling server running on port 4001
WebSocket endpoint: ws://localhost:4001
```

## 2. Next.js 애플리케이션 실행

메인 프로젝트 폴더에서:
```bash
npm run dev
```

## 3. 스트리밍 테스트 방법

### 방법 1: 같은 브라우저에서 테스트
1. **스트리머 역할**: `http://localhost:4000`에서 PDF를 업로드하고 "실시간 공유" 버튼 클릭
2. **새 탭 열기**: 스트리밍 URL을 복사하여 새 탭에서 접속
3. **결과**: 두 번째 탭에서 첫 번째 탭의 화면을 실시간으로 볼 수 있음

### 방법 2: 다른 브라우저에서 테스트 (권장)
1. **Chrome에서 스트리머**: `http://localhost:4000`에서 스트리밍 시작
2. **Firefox에서 뷰어**: 스트리밍 URL을 복사하여 Firefox에서 접속
3. **결과**: Firefox에서 Chrome의 화면을 실시간으로 볼 수 있음

### 방법 3: 다른 기기에서 테스트
1. **메인 PC에서 스트리머**: `http://localhost:4000`에서 스트리밍 시작
2. **다른 기기에서 뷰어**: 같은 네트워크의 다른 기기에서 `http://[PC IP]:4000/stream/[streamId]` 접속

## 4. 테스트 시 확인사항

### 스트리머 측에서 확인할 것:
- [ ] 화면 공유 권한 허용
- [ ] 마이크 권한 허용 (선택사항)
- [ ] 스트리밍 상태가 "연결됨"으로 표시
- [ ] 뷰어 수가 증가하는지 확인
- [ ] 브라우저 콘솔에서 WebRTC 연결 로그 확인

### 뷰어 측에서 확인할 것:
- [ ] "스트림에 연결 중..." 메시지 후 비디오 표시
- [ ] 실시간으로 스트리머 화면이 업데이트되는지 확인
- [ ] 오디오가 들리는지 확인 (음소거 해제 버튼 클릭)
- [ ] 브라우저 콘솔에서 WebRTC 연결 로그 확인

## 5. 트러블슈팅

### 연결이 안 되는 경우:
1. **시그널링 서버 상태 확인**: `http://localhost:4001`에서 서버 상태 확인
2. **방화벽 설정**: Windows 방화벽에서 Node.js와 브라우저 허용
3. **브라우저 콘솔 확인**: F12를 눌러 콘솔에서 에러 메시지 확인
4. **STUN 서버 연결**: 네트워크가 STUN 서버에 접근 가능한지 확인

### 비디오가 안 보이는 경우:
1. **권한 확인**: 브라우저에서 화면 공유 권한이 허용되었는지 확인
2. **스트림 상태**: 스트리머가 실제로 스트리밍을 시작했는지 확인
3. **WebRTC 지원**: 브라우저가 WebRTC를 지원하는지 확인

### 오디오가 안 들리는 경우:
1. **음소거 상태**: 뷰어에서 음소거가 해제되어 있는지 확인
2. **마이크 권한**: 스트리머가 마이크 권한을 허용했는지 확인
3. **시스템 오디오**: 스트리머가 시스템 오디오를 공유하고 있는지 확인

## 6. 개발자 도구에서 확인할 로그

### 정상적인 연결 시 나타나는 로그:
```
시그널링 서버에 연결되었습니다
스트림 시작됨: [streamId]
새 뷰어 참여: [viewerId]
Offer 수신/전송
Answer 수신/전송  
ICE candidate 추가 완료
Connection state: connected
```

## 7. 네트워크 설정

### 로컬 네트워크에서 테스트하려면:
1. **IP 주소 확인**: `ipconfig`로 PC의 IP 주소 확인
2. **방화벽 설정**: 포트 4000, 4001을 방화벽에서 허용
3. **라우터 설정**: 필요시 포트 포워딩 설정

### 외부 네트워크에서 테스트하려면:
1. **TURN 서버**: NAT 통과를 위해 TURN 서버 필요
2. **공인 IP**: 라우터에서 포트 포워딩 설정
3. **HTTPS**: 일부 브라우저에서는 HTTPS 필요

## 예상되는 스트리밍 URL 형식:
```
http://localhost:4000/stream/lt7r9x2s8k1a3mno
```

이 URL을 다른 브라우저나 기기에서 열면 실시간 스트림을 볼 수 있습니다.
